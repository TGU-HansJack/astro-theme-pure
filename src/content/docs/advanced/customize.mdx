---
title: '自定义主题'
description: '自己定制主题'
order: 2
---

import { Aside, Spoiler, Steps } from 'astro-pure/user'

## 你需要知道

本主题设计为"NPM包"形式，原因如下：

1. 包中的代码可能会频繁更改。如果用户随意更改，将显著增加后续更新和合并的成本（各种代码冲突）
2. 轻松回滚和在不同版本间切换，以保持用户稳定性
3. 降低系统耦合度并增加复用能力
4. NPM包模式可以作为"astro插件"，在构建阶段附加额外操作以增强用户体验
5. 支持一些内置命令，如new、check、info等
6. 可作为其他astro项目的组件库使用（是的，该项目可以分解为UI组件库）：[包详情](https://www.npmjs.com/package/astro-pure)。

在自定义之前，你应该检查 [`site.config.ts`](/docs/setup/configuration#theme-configuration) 以确保没有能满足你需求的选项。

## Swizzling

本主题选择了一种优雅的方法，称为'Swizzling'，灵感来自[Docusaurus](https://docusaurus.io/docs/swizzling)的设计。

1. 使用IDE快速查看对应某个组件的源代码（在VSCode中，按住<kbd>Ctrl</kbd>点击组件）。
2. 复制到 `src/components/<你的首选目录>`。
3. 修改后，将相应的引用更改为自己的文件路径。

让我们以自定义 `Footer` 组件为例：

<Steps>
1. 在项目代码中搜索 `Footer` 组件：

   ```astro title="src/layout/BaseLayout.astro"
   ---
   import { Footer, Header, ThemeProvider } from 'astro-pure/components/basic'
   import type { SiteMeta } from 'astro-pure/types'
   // ...
   ---
   ```

2. 在主题源代码中找到它：

   ```ts title="node_modules/astro-theme-pure/components/basic/index.ts"
   export { default as Footer } from './Footer.astro'
   export { default as Header } from './Header.astro'
   export { default as ThemeProvider } from './ThemeProvider.astro'
   ```

   然后你会在 `node_modules/astro-theme-pure/components/basic/Footer.astro` 找到 `Footer` 组件的源代码。

3. 将 `Footer.astro` 文件复制到你的项目中：

   ```bash
   cp node_modules/astro-theme-pure/components/basic/Footer.astro src/components/custom/Footer.astro
   ```

4. 解决子依赖问题：

   ```astro title="src/components/custom/Footer.astro"
   ---
   import config from 'virtual:config'

   import { Icon } from '../user' // [!code --]
   import { Icon } from 'astro-pure/user' // [!code ++]
   // ...
   ---
   ```

5. 修改 `BaseLayout.astro` 中的引用：

   ```astro title="src/layout/BaseLayout.astro"
    ---
    import { Footer, Header, ThemeProvider } from 'astro-pure/components/basic' // [!code --]
    import { Header, ThemeProvider } from 'astro-pure/components/basic' // [!code ++]
    import { Footer } from '@/components/custom/Footer.astro' // [!code ++]
    // ...
    ---
    ```

</Steps>

然后你就完成了组件的"本地化"。

## 包模式

<Aside type='danger' title={'使用风险自负'.toUpperCase()}>
谨慎更改底层代码 <Spoiler>~~底层代码不可突破，祖宗之法不可变~~</Spoiler>，除非你知道自己在做什么。你应该了解并接受任何使项目复杂化的风险和困难。
</Aside>

如果你想做一些突破性更改或只是进行测试，这种方法可能遵循"所见即所得"。

1. 确保你有原始主题代码（`./packages/pure`）。如果你已删除，从[Releases](https://github.com/cworld1/astro-theme-pure/releases)下载。
2. 使用你的包管理器将其链接到你的项目。
3. 然后像更改自己代码一样更改主题代码！

<Aside type='tip'>
对于bun用户，请参考[部署#包模式](/docs/setup/deployment#package-mode)

这也可以帮助你在云CI/CD上正确构建项目。
</Aside>